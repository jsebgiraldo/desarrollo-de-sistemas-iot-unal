{
  "mode": "basic",
  "name": "MQTT-CONNECTOR",
  "type": "mqtt",
  "logLevel": "INFO",
  "sendDataOnlyOnChange": false,
  "configuration": "mqttConnector.json",
  "configurationJson": {
    "broker": {
      "host": "127.0.0.1",
      "port": 1884,
      "version": 5,
      "clientId": "ThingsBoard_gateway",
      "security": {
        "type": "anonymous"
      },
      "maxNumberOfWorkers": 100,
      "maxMessageNumberPerWorker": 10
    },
    "mapping": [
      {
        "converter": {
          "type": "json",
          "deviceTypeJsonExpression": "${sensorType}",
          "sendDataOnlyOnChange": false,
          "timeout": 60000,
          "attributes": [
            {
              "type": "string",
              "key": "model",
              "value": "${sensorModel}"
            },
            {
              "type": "string",
              "key": "${sensorModel}",
              "value": "on"
            }
          ],
          "timeseries": [
            {
              "type": "double",
              "key": "temperature",
              "value": "${temp}"
            },
            {
              "type": "double",
              "key": "humidity",
              "value": "${hum}"
            },
            {
              "type": "string",
              "key": "combine",
              "value": "${hum}:${temp}"
            }
          ],
          "deviceNameJsonExpression": "${serialNumber}"
        },
        "topicFilter": "sensor/data"
      },
      {
        "converter": {
          "type": "json",
          "deviceTypeTopicExpression": "Thermometer",
          "sendDataOnlyOnChange": false,
          "timeout": 60000,
          "attributes": [
            {
              "type": "string",
              "key": "model",
              "value": "${sensorModel}"
            }
          ],
          "timeseries": [
            {
              "type": "double",
              "key": "temperature",
              "value": "${temp}"
            },
            {
              "type": "double",
              "key": "humidity",
              "value": "${hum}"
            }
          ],
          "deviceNameTopicExpression": "(?<=sensor/)(.*?)(?=/data)"
        },
        "topicFilter": "sensor/+/data"
      },
      {
        "converter": {
          "type": "bytes",
          "deviceNameExpression": "[0:4]",
          "deviceTypeExpression": "default",
          "sendDataOnlyOnChange": false,
          "timeout": 60000,
          "attributes": [
            {
              "type": "raw",
              "key": "rawData",
              "value": "[:]"
            }
          ],
          "timeseries": [
            {
              "type": "raw",
              "key": "temp",
              "value": "[4:]"
            }
          ]
        },
        "topicFilter": "sensor/raw_data"
      },
      {
        "converter": {
          "type": "custom",
          "extension": "CustomMqttUplinkConverter",
          "cached": true,
          "deviceTypeTopicExpression": "default"
        },
        "topicFilter": "custom/sensors/+"
      }
    ],
    "connectRequests": [
      {
        "topicFilter": "sensor/connect",
        "deviceNameJsonExpression": "${serialNumber}"
      },
      {
        "topicFilter": "sensor/+/connect",
        "deviceNameTopicExpression": "(?<=sensor/)(.*?)(?=/connect)"
      }
    ],
    "disconnectRequests": [
      {
        "topicFilter": "sensor/disconnect",
        "deviceNameJsonExpression": "${serialNumber}"
      },
      {
        "topicFilter": "sensor/+/disconnect",
        "deviceNameTopicExpression": "(?<=sensor/)(.*?)(?=/disconnect)"
      }
    ],
    "attributeRequests": [
      {
        "retain": false,
        "topicFilter": "v1/devices/me/attributes/request",
        "topicExpression": "devices/${deviceName}/attrs",
        "valueExpression": "${attributeKey}: ${attributeValue}",
        "attributeNameJsonExpression": "${versionAttribute}, ${pduAttribute}",
        "deviceNameJsonExpression": "${serialNumber}"
      }
    ],
    "attributeUpdates": [
      {
        "retain": true,
        "deviceNameFilter": ".*",
        "attributeFilter": "firmwareVersion",
        "topicExpression": "sensor/${deviceName}/${attributeKey}",
        "valueExpression": "{\"${attributeKey}\":\"${attributeValue}\"}"
      }
    ],
    "serverSideRpc": [
      {
        "deviceNameFilter": ".*",
        "methodFilter": "echo",
        "requestTopicExpression": "sensor/${deviceName}/request/${methodName}/${requestId}",
        "responseTopicExpression": "sensor/${deviceName}/response/${methodName}/${requestId}",
        "responseTimeout": 10000,
        "valueExpression": "${params}"
      },
      {
        "deviceNameFilter": ".*",
        "methodFilter": "no-reply",
        "requestTopicExpression": "sensor/${deviceName}/request/${methodName}/${requestId}",
        "valueExpression": "${params}"
      }
    ],
    "logLevel": "INFO",
    "name": "MQTT-CONNECTOR",
    "enableRemoteLogging": false,
    "id": "e4eaa3ae-665d-493a-80eb-020c30cf2bcb",
    "configVersion": ""
  },
  "configVersion": "",
  "ts": 1756159102616
}